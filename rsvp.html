<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8"/>
<meta name="robots" content="noindex,nofollow">

<head>
<title>Zoe and Peter's Wedding</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>
-->
<!--Bootstrap and dependencies-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>

<nav class="navbar navbar-expand flex-column" id="header"></nav>

<div class="container">
  <h2>RSVP</h2>
  <br>
  <div class="collapse collapse-rsvpError">
    <h3 class="text-danger">Failed to update database</h3>
    <p id="rsvpErrorMsg"></p>
  </div>
  <div class="collapse collapse-rsvpSuccess">
    <h3 class="text-success">Success! Thank you for updating us.</h3>
  </div>
  <form>
    <div class="form-group col-md-12"><label>Name</label></div>
    <div class="form-row">
      <div class="form-group col-md-6">
        <input type="text" class="form-control" id="rsvpFirstName" aria-describedby="rsvpFirstNameLabel" maxlength="32">
        <small id="rsvpFirstNameLabel" class="form-text text-mutex">First Name</small>
      </div>
      <div class="form-group col-md-6">
        <input type="text" class="form-control" id="rsvpLastName" aria-describedby="rsvpLastNameLabel" maxlength="32">
        <small id="rsvpLastNameLabel" class="form-text text-mutex">Last Name</small>
      </div>
    </div>
    <div class="form-group col-md-12">
      <label for="rsvpAttending">Are you attending?</label>
      <input type="text" class="form-control" id="rsvpAttending">
    </div>
    <div class="form-group col-md-12">
      <label for="rsvpWhoElse">Who else is coming with you?</label>
      <input type="text" class="form-control" id="rsvpWhoElse">
    </div>
    <div class="form-group col-md-12">
      <label for="rsvpBusInterest"> Would you take a bus* if it was an option?</label>
      <input type="text" class="form-control" id="rsvpBusInterest" aria-describedby="busExplainer">
      <small id=busExplainer>*If we get enough interest, we will provide a bus from a central location to the venue and back.</small>
    </div>
    <div class="form-group col-md-12">
      <label for="rsvpSongs">What songs will get you on the dance floor?</label>
      <textarea class="form-control" id="rsvpSongs" rows="2"></textarea>
    </div>
    <button type="button" class="btn btn-primary" id="rsvpSubmit">Submit</button>
  </form>
</div>

<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-analytics.js"></script>

<script>
  $(document).ready(function(){
    // Pull in header
    $("#header").load("header.html")

    // Initialize Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyCPdEtSwodTo2Kg1LJk06bSmtGeIH1zyLk",
      authDomain: "zoepeter-fab29.firebaseapp.com",
      databaseURL: "https://zoepeter-fab29.firebaseio.com",
      projectId: "zoepeter-fab29",
      storageBucket: "zoepeter-fab29.appspot.com",
      messagingSenderId: "21329665131",
      appId: "1:21329665131:web:84d6180895af345140652e",
      measurementId: "G-5SP8B0650R"
    };
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();

    // Initialise Html
    $("#rsvpSubmit").click(submitRsvp);
 
    $("#rsvpSongs").css("resize", "vertical");

    refreshRegistry();
  });

  function submitRsvp(name) {
    var rsvpObject = {
      firstName: $("#rsvpFirstName").val(),
      lastName: $("#rsvpLastName").val(),
      attending: $("#rsvpAttending").val(),
      whoElse: $("#rsvpWhoElse").val(),
      busInterest: $("#rsvpBusInterest").val(),
      songSuggestions: $("#rsvpSongs").val()
    };
    console.log("Submitted: "+rsvpObject)
    firebase.database().ref('rsvps').push().set(rsvpObject).then(
      function(snapshot) {
        $(".collapse-rsvpSuccess").collapse("show")
        $(".collapse-rsvpError").collapse("hide")
      }, function(error) {
        $(".collapse-rsvpSuccess").collapse("hide")
        $(".collapse-rsvpError").collapse("show")
      }
    );
  }
  function refreshRegistry() {
    
  }
</script>

</body>
</html>

